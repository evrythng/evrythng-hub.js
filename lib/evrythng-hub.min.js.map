{"version":3,"sources":["evrythng-hub.js"],"names":["root","factory","define","amd","load","moduleName","parentRequire","onload","onLoadSuccess","moduleInstance","onLoadFailure","err","failedId","requireModules","requirejs","undef","WS","JWT","Jose","undefined","exports","MQTT","tryLoading","name","module","require","e","EVT","Hub","Evrythng","KJUR","nodeJose","this","_isObject","obj","Object","prototype","toString","call","generateId","util","base64url","encode","randomBytes","initSecretKey","key","JWK","asKey","encrypt","input","options","JSON","stringify","JWE","createEncrypt","update","final","decrypt","createDecrypt","then","result","plaintext","createJWT","kid","header","alg","typ","claims","iss","aud","sub","jti","data","jws","JWS","sign","verifyJWT","validateOptions","decodeJWT","split","parse","decode","payload","encryptHeader","secretKey","format","encryptPayload","jwt","decryptPayload","isValid","Error","version","defaultSettings","httpApiUrl","mqttApiUrl","wsApiUrl","timeout","remote","secure","request","response","hubId","localEndpoints","path","method","EVTHubPlugin","settings","setup","customSettings","validateSettings","console","warn","TypeError","i","hasOwnProperty","install","Resource","localApi","args","arguments","interceptors","getUrl","getThng","getSecretKey","buildEncrypted","concat","original","api","apply","catch","pubSubPlugin","cancelled","info","apiUrl","localPubSub","$this","cachedApiKey","apiKey","remoteApiUrl","localApiUrl","$resource","cachedCallback","isEncryptedKey","scope","encryptedKeyMap","cancel","headers","authorization","isResponseSecure","secureCallback","url","isRemote","supportedByHub","isSecure","hubThng","thng","hasSecretKey","customFields","promises","cachedOptions","push","Promise","resolve","getEncryptedKey","all","encrypted","res","buildDecrypted","decrypted","getSecurityOption","isRequestSecure","indexOf","secret","encryptedKeyPromiseMap","encryptedKeyPromise","exec","length","test","entity","cb","msg","resource","subscribe","publish","utils","$inject"],"mappings":"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","file":"evrythng-hub.min.js"}