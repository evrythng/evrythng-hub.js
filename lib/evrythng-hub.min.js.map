{"version":3,"sources":["evrythng-hub.js"],"names":["root","factory","define","amd","load","moduleName","parentRequire","onload","onLoadSuccess","moduleInstance","onLoadFailure","err","failedId","requireModules","requirejs","undef","WS","JWT","Jose","undefined","exports","MQTT","tryLoading","name","module","require","e","EVT","Hub","Evrythng","KJUR","nodeJose","this","_isObject","obj","Object","prototype","toString","call","generateId","util","base64url","encode","randomBytes","initSecretKey","key","JWK","asKey","encrypt","input","options","JSON","stringify","JWE","createEncrypt","update","decrypt","createDecrypt","then","result","plaintext","createJWT","kid","header","alg","typ","claims","iss","aud","sub","jti","data","jws","JWS","sign","verifyJWT","validateOptions","decodeJWT","split","parse","decode","payload","encryptHeader","secretKey","format","encryptPayload","jwt","decryptPayload","isValid","Error","version","defaultSettings","httpApiUrl","mqttApiUrl","wsApiUrl","timeout","remote","secure","hubId","localEndpoints","path","method","EVTHubPlugin","settings","setup","customSettings","validateSettings","console","warn","apiUrl","TypeError","i","hasOwnProperty","install","Resource","localApi","args","arguments","interceptors","request","getUrl","getThng","getSecretKey","buildEncrypted","concat","original","api","apply","pubSubPlugin","cancelled","localPubSub","$this","cachedApiKey","apiKey","remoteApiUrl","localApiUrl","$resource","cachedCallback","isEncryptedKey","scope","encryptedKeyMap","cancel","headers","authorization","secureCallback","url","isRemote","supportedByHub","isSecure","hubThng","thng","hasSecretKey","customFields","promises","cachedOptions","push","Promise","resolve","getEncryptedKey","all","encrypted","response","res","buildDecrypted","decrypted","indexOf","secret","encryptedKeyPromiseMap","encryptedKeyPromise","exec","length","test","entity","cb","msg","resource","subscribe","publish","utils","$inject"],"mappings":"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","file":"evrythng-hub.min.js"}