!function(a,b){"use strict";if("function"==typeof define&&define.amd)define("optional",[],{load:function(a,b,c){var d=function(a){c(a)},e=function(a){var c=a.requireModules&&a.requireModules[0];requirejs.undef(c),define(c,[],function(){}),b([c],d)};b([a],d,e)}}),define(["optional!evrythng-ws"],function(a){return b(void 0,a)});else if("object"==typeof exports){var c;try{c=require("evrythng-mqtt")}catch(d){c=void 0}module.exports=b(c,void 0)}else a.EVT.Hub=a.Evrythng.Hub=b(void 0,a.EVT.WS)}(this,function(a,b){"use strict";var c="1.1.1",d={httpApiUrl:"http://localhost:8787",mqttApiUrl:"mqtt://localhost:4001/mqtt",wsApiUrl:"ws://localhost:4000/mqtt",timeout:1e3,remote:!1},e=[{path:/^\/thngs$/,method:["get"]},{path:/^\/thngs\/[^\/]+$/,method:["get"]},{path:/^\/thngs\/[^\/]+\/properties$/,method:["post","get","put"]},{path:/^\/thngs\/[^\/]+\/properties\/[^\/]+$/,method:["get","put"]},{path:/^\/thngs\/[^\/]+\/actions\/[^\/]+$/,method:["post","get"]},{path:/^\/thngs\/[^\/]+\/actions\/[^\/]+\/[^\/]+$/,method:["get"]},{path:/^\/collections$/,method:["get"]},{path:/^\/collections\/[^\/]+$/,method:["get"]},{path:/^\/collections\/[^\/]+\/thngs$/,method:["get"]},{path:/^\/collections\/[^\/]+\/actions\/[^\/]+$/,method:["post","get"]},{path:/^\/collections\/[^\/]+\/actions\/[^\/]+\/[^\/]+$/,method:["get"]},{path:/^\/actions$/,method:["get"]}],f={version:c,settings:d,setup:function(a){if("[object Object]"!==Object.prototype.toString.call(a))throw new TypeError("Setup should be called with an options object.");for(var b in a)if(a.hasOwnProperty(b)){if("apiUrl"===b){console.warn("[EvrythngJS Hub] apiUrl option has been deprecated. Use httpApiUrl instead."),this.settings.httpApiUrl=a[b];continue}this.settings[b]=a[b]}return this.settings},install:function(c,d){function f(a){var b=void 0!==a.remote?a.remote:h.settings.remote;if(b)return j.api.apply(c,arguments);for(var d=/^(.*?)(\?|$)/.exec(a.url)[1],f=a.method||"get",g=arguments,k=0;k<e.length&&(!e[k].path.test(d)||-1===e[k].method.indexOf(f));k++);return k<e.length?(a.apiUrl=h.settings.httpApiUrl,a.timeout=h.settings.timeout,j.api.apply(c,g)["catch"](function(b){return i&&b&&b.cancelled?void 0:(delete a.apiUrl,delete a.timeout,j.api.apply(c,g))})):j.api.apply(c,g)}function g(b){return function(){if(h.settings.remote)return j[b].apply(this,arguments);var c=i.settings.apiUrl,d=i===a?h.settings.mqttApiUrl:h.settings.wsApiUrl,e=this,f=arguments;return i.setup({apiUrl:d}),j[b].apply(e,f)["catch"](function(){return i.setup({apiUrl:c}),j[b].apply(e,f)})}}var h=this,i=a||b,j={api:c.api,subscribe:d.prototype.subscribe,publish:d.prototype.publish};c.api=f,i&&(d.prototype.subscribe=g("subscribe"),d.prototype.publish=g("publish"))}};return f.$inject=["core","resource"],f});
//# sourceMappingURL=evrythng-hub.min.js.map