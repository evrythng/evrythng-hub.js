{"version":3,"sources":["evrythng-hub.js"],"names":["root","factory","define","amd","load","moduleName","parentRequire","onload","onLoadSuccess","moduleInstance","onLoadFailure","err","failedId","requireModules","requirejs","undef","WS","JWT","Jose","undefined","exports","MQTT","tryLoading","name","module","require","e","EVT","Hub","Evrythng","KJUR","nodeJose","this","_isObject","obj","Object","prototype","toString","call","generateId","util","base64url","encode","randomBytes","initSecretKey","key","JWK","asKey","encrypt","input","options","JSON","stringify","JWE","createEncrypt","update","decrypt","createDecrypt","then","result","plaintext","createJWT","kid","header","alg","typ","claims","iss","aud","sub","jti","data","jws","JWS","sign","verifyJWT","validateOptions","decodeJWT","split","parse","decode","payload","encryptHeader","secretKey","format","encryptPayload","jwt","decryptPayload","isValid","Error","version","defaultSettings","httpApiUrl","mqttApiUrl","wsApiUrl","timeout","remote","secure","hubId","localEndpoints","path","method","EVTHubPlugin","settings","setup","customSettings","validateSettings","console","warn","apiUrl","TypeError","i","hasOwnProperty","install","Resource","localApi","$this","original","api","apply","arguments","exec","url","args","length","test","indexOf","securePromise","getSecretKey","authorization","trySecureRequest","pubSubPlugin","cancelled","switchToRemote","localPubsubMethod","remoteApiUrl","localApiUrl","$resource","scope","apiKey","encryptedApiKey","encryptedApiKeyPromise","trySecureSubscribe","trySecurePublish","cachedSuccessCb","cachedHeader","cachedPayload","buildEncryptedRequest","encrypted","response","decrypted","promises","push","Promise","all","resource","msgCallbackUpdated","msgCallback","cachedApiKey","msg","decryptedMsg","subscribePromise","cachedApiMethod","encryptBeforePublish","publishPromise","loadThng","thng","hasSecretKey","customFields","id","requestOptions","entity","req","publishInterceptor","interceptors","request","cancel","subscribe","publish","geolocation","utils","$inject"],"mappings":"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","file":"evrythng-hub.min.js"}